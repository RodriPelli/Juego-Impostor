<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Juego del Impostor Mejorado</title>

  <!-- ESTILOS MODERNOS + TEMAS + ANIMACIONES -->
  <style>
    :root {
      --bg: #1a1a1a;
      --card: #242424;
      --text: #ffffff;
      --primary: #ff0080;
      --secondary: #4a00e0;
    }

    [data-theme="neon"] {
      --bg: #000000;
      --card: #111111;
      --text: #00ffea;
      --primary: #ff00f7;
      --secondary: #00eaff;
    }

    [data-theme="pastel"] {
      --bg: #f9f5ff;
      --card: #ffffff;
      --text: #4b3f72;
      --primary: #ff9ecd;
      --secondary: #8ec6ff;
    }

    [data-theme="oscuro"] {
      --bg: #0e0e0e;
      --card: #1a1a1a;
      --text: #e8e8e8;
      --primary: #bb86fc;
      --secondary: #03dac6;
    }

    body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font-family: 'Poppins', sans-serif;
      display: flex;
      justify-content: center;
      padding: 20px;
      transition: background 0.4s ease;
    }

    .container {
      width: 100%;
      max-width: 480px;
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: var(--card);
      padding: 20px;
      margin: 15px 0;
      border-radius: 16px;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      transition: 0.3s;
      animation: fadeIn 0.5s ease;
    }

    button {
      width: 100%;
      padding: 14px;
      border: none;
      border-radius: 10px;
      margin-top: 12px;
      color: white;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      font-size: 1.1rem;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      opacity: 0.85;
      transform: scale(1.03);
    }

    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      border-radius: 10px;
      border: none;
      outline: none;
      font-size: 1rem;
    }

    .delete-btn {
      background: #ff0033;
      margin-top: 5px;
    }

    #reveal-screen {
      animation: fadeIn 0.4s ease;
    }
  </style>
</head>
<body data-theme="default">
<div class="container">
  <h1>Juego del Impostor üî•</h1>

  <!-- TEMAS -->
  <div class="card">
    <h2>Temas</h2>
    <select id="theme-select">
      <option value="default">Moderno</option>
      <option value="neon">Ne√≥n</option>
      <option value="pastel">Pastel</option>
      <option value="oscuro">Oscuro</option>
    </select>
  </div>

  <!-- CATEGOR√çAS -->
  <div class="card">
    <h2>Categor√≠as</h2>
    <select id="category-select"></select>

    <h3>Agregar palabra</h3>
    <input id="new-word" placeholder="Nueva palabra" />
    <button onclick="addWord()">Agregar palabra</button>

    <h3>Nueva categor√≠a</h3>
    <input id="new-category" placeholder="Nombre de categor√≠a" />
    <button onclick="addCategory()">Crear categor√≠a</button>

    <h3>Palabras</h3>
    <ul id="word-list"></ul>

    <button class="delete-btn" onclick="deleteCategory()">Eliminar categor√≠a</button>
  </div>

  <!-- DOBLE IMPOSTOR -->
  <div class="card">
    <h2>Modo de juego</h2>
    <select id="impostor-mode">
      <option value="1">1 Impostor</option>
      <option value="2">2 Impostores</option>
    </select>
  </div>

  <!-- JUGADORES -->
  <div class="card">
    <h2>Jugadores</h2>
    <input id="player-name" placeholder="Nombre" />
    <button onclick="addPlayer()">Agregar jugador</button>
    <ul id="players"></ul>
    <button onclick="startGame()">Iniciar juego</button>
  </div>

  <!-- REVELAR -->
  <div class="card" id="reveal-screen" style="display:none; text-align:center;">
    <h2 id="reveal-text" style="font-size:2rem;"></h2>
    <button onclick="closeReveal()">Cerrar</button>
  </div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "YOUR_KEY",
    authDomain: "",
    projectId: "",
    storageBucket: "",
    messagingSenderId: "",
    appId: ""
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  let categories = {};
  let players = [];
  let chosenCategory = null;
  let assignments = {};

  // CARGAR CATEGOR√çAS
  async function loadCategories() {
    const snapshot = await db.collection("categories").get();
    categories = {};
    snapshot.forEach(doc => categories[doc.id] = doc.data().words);
    renderCategorySelect();
  }

  function renderCategorySelect() {
    const sel = document.getElementById("category-select");
    sel.innerHTML = "";
    Object.keys(categories).forEach(cat => {
      sel.innerHTML += `<option value="${cat}">${cat}</option>`;
    });
    renderWords();
  }

  function renderWords() {
    const cat = document.getElementById("category-select").value;
    chosenCategory = cat;
    const list = document.getElementById("word-list");
    list.innerHTML = "";

    categories[cat]?.forEach((w, i) => {
      list.innerHTML += `<li>${w} <button class='delete-btn' onclick='deleteWord(${i})'>X</button></li>`;
    });
  }

  // TEMAS
  document.getElementById("theme-select").onchange = (e) => {
    document.body.setAttribute("data-theme", e.target.value);
  };

  // AGREGAR PALABRA
  async function addWord() {
    const w = document.getElementById("new-word").value.trim();
    if (!w) return;

    categories[chosenCategory].push(w);
    await db.collection("categories").doc(chosenCategory).set({ words: categories[chosenCategory] });

    renderWords();
    document.getElementById("new-word").value = "";
  }

  // ELIMINAR PALABRA
  async function deleteWord(index) {
    categories[chosenCategory].splice(index, 1);
    await db.collection("categories").doc(chosenCategory).set({ words: categories[chosenCategory] });
    renderWords();
  }

  // AGREGAR CATEGOR√çA
  async function addCategory() {
    const c = document.getElement

